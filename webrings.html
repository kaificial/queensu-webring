<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="./css/output.css" rel="stylesheet" />

  <!-- prevent visible alpinejs page reloading -->
  <style>
    [x-cloak] {
      display: none;
    }
    .btn-hover {
      transition: all 0.2s;
    }
    .btn-hover:hover {
      background: #e6e6e6;
      color: #0c0c0c;
    }
    input, button {
      color: #ffffff;
      background-color: transparent;
    }
    input::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }
    .divider {
      border: 0;
      border-top: 1px solid #ffffff;
      margin: 1rem auto;
      flex-shrink: 0;
    }
    /* Scrollbar styles */
    #webring-list::-webkit-scrollbar {
      width: 8px;
    }
    #webring-list::-webkit-scrollbar-track {
      background: #1a1a1a;
    }
    #webring-list::-webkit-scrollbar-thumb {
      background: #444444;
      border-radius: 4px;
    }
    #webring-list::-webkit-scrollbar-thumb:hover {
      background: #666666;
    }
    /* Firefox */
    #webring-list {
      scrollbar-width: thin;
      scrollbar-color: #444444 #1a1a1a;
    }
    #webring-logo {
      width: 64px !important;
      height: 64px !important;
      display: block !important;
    }
    #webring-logo canvas {
      width: 64px !important;
      height: 64px !important;
      max-width: 64px !important;
      max-height: 64px !important;
    }
    .text-info-grey {
      color: #b8b8b8;
    }
  </style>

  <!-- SEO Meta Tags -->
  <title>CS Webring</title>
  <meta name="description" content="A webring for Computer Science students and alumni at the University of Waterloo.">
  <meta name="keywords" content="webring, UWaterloo, Computer Science, CS, personal websites, student portfolio">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://cs.uwatering.com/">
  <meta property="og:title" content="CS Webring">
  <meta property="og:description"
    content="A webring for Computer Science students and alumni at the University of Waterloo.">
  <meta property="og:image" content="https://cs.uwatering.com/webAssets/og.png">
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://cs.uwatering.com/">
  <meta property="twitter:title" content="CS Webring">
  <meta property="twitter:description"
    content="A webring for Computer Science students and alumni at the University of Waterloo.">
  <meta property="twitter:image" content="https://cs.uwatering.com/webAssets/og.png">

  <!-- JS sources -->
  <script src="//unpkg.com/alpinejs" defer></script>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script type="importmap">
    {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.161.0/build/three.module.js"
      }
    }
  </script>

  <!-- Get program from URL hash -->
  <script type="module">
    let program = window.location.hash.slice(1) || "cs";

    try {
      const response = await fetch(`./sites/${program}.json`);
      if (!response.ok) throw new Error(`Failed to load ${program}.json`);
      const sites = await response.json();

      window.webringData = { sites: sites };

      // Set data-model before loading three-scene.js
      const logo = document.getElementById("webring-logo");
      if (logo) {
        logo.setAttribute("data-model", `./assets/model/${program}_webring_logo.gltf`);
      }

      await import("./js/script.js");

      // Wait for layout to complete before initializing Three.js
      requestAnimationFrame(() => {
        requestAnimationFrame(() => {
          import("./js/three-scene.js");
        });
      });
    } catch (error) {
      console.error("Error loading webring data:", error);
      document.getElementById("webring-list").innerHTML =
        `<p class="text-burgundy-500">Failed to load webring data for "${program}"</p>`;
    }
  </script>
</head>

<body style="background-color: #0c0c0c; color: #e6e6e6; font-family: monospace;">
  <main class="text-white px-4 py-6 sm:p-6 w-full flex flex-col items-center" style="height: 100vh; overflow: hidden;">

    <hr class="divider w-full sm:w-3/5 lg:w-2/5">

    <div class="w-full sm:w-3/5 lg:w-2/5 mx-auto" style="flex-shrink: 0;">
      <div class="flex flex-row justify-between items-center w-full">
        <div class="flex flex-row items-center">
          <img src="" alt="Logo" class="rounded-full" id="webring-logo" style="width: 4rem; height: 4rem;">
          <!-- <span aria-hidden="true" data-qmodel="logo" data-model="" id="webring-logo" data-edge-angle="10" style="display: block; overflow: hidden; flex-shrink: 0;"></span> -->
          <h1 class="text-2xl font-monospace font-bold text-white" id="webring-title">QUEENSU-WEBRING</h1>
        </div>
        <button onclick="window.location.href = 'index.html'" class="text-2xl font-monospace font-bold text-white whitespace-nowrap" style="cursor: pointer;">‚ÜêBACK</button>
      </div>
    </div>

    <hr class="divider w-full sm:w-3/5 lg:w-2/5">

    <div class="mb-4 w-full sm:w-3/5 lg:w-2/5 mx-auto" style="flex-shrink: 0;">
      <input type="text" id="search" placeholder="Search members by name, year or url..."
        class="w-full font-monospace px-4 py-2 border border-white rounded-none" />
    </div>

    <div class="w-full sm:w-3/5 lg:w-2/5 mx-auto" style="flex-shrink: 0;">
      <div class="flex flex-row flex-wrap" style="gap: 1rem;">
        <button onclick="window.open('https://github.com/AaronSu06/QU-Webring/issues/new?title=Report%20Broken%20Link&body=Website%20Lnk%3A%20%5BEnter%20URL%5D%0AMember%3A%20%5BName%20if%20available%5D%0ADetails%3A%20%5BDescribe%20what%27s%20broken%20-%20site%20offline%2C%20domain%20expired%2C%20etc.%5D', '_blank')" class="btn-hover font-monospace px-4 py-2 border border-white rounded-none" style="cursor: pointer; flex: 1 1 150px;">Report Broken Link</button>
        <button onclick="window.open('https://github.com/AaronSu06/QU-Webring', '_blank')" class="btn-hover font-monospace px-4 py-2 border border-white rounded-none" style="cursor: pointer; flex: 1 1 150px;">Join the Webring</button>
        <button onclick="window.location.href = window.webringData.sites[Math.floor(Math.random() * window.webringData.sites.length)].website" class="btn-hover font-monospace px-4 py-2 border border-white rounded-none" style="cursor: pointer; flex: 1 1 150px;">Random</button>
      </div>
    </div>

    <p class="mt-4 w-full sm:w-3/5 lg:w-2/5 mx-auto text-base font-monospace text-info-grey" style="flex-shrink: 0;" id="webring-info"> </p>

    <hr class="divider w-full sm:w-3/5 lg:w-2/5">

    <div class="w-full sm:w-3/5 lg:w-2/5 mx-auto" style="flex: 1; min-height: 0; display: flex; flex-direction: column; overflow: hidden;">
      <div style="display: flex; flex-direction: column; height: 100%;">
        <div class="grid grid-cols-12 sm:grid-cols-6 gap-2 sm:gap-4 mb-2 mt-4" style="flex-shrink: 0;">
          <span class="col-span-5 sm:col-span-2 text-left font-monospace text-white text-2xl italic font-bold">NAME</span>
          <span class="col-span-2 sm:col-span-1 text-right font-monospace text-white text-2xl italic font-bold">YEAR</span>
          <span class="col-span-1 sm:col-span-1"></span>
          <span class="col-span-4 sm:col-span-2 text-left font-monospace text-white text-2xl italic font-bold">URL</span>
        </div>
        <div class="w-full flex flex-col space-y-1 py-6 text-sm sm:text-base" style="flex: 1; overflow-y: auto;" id="webring-list">
        </div>
      </div>
    </div>

    <hr class="divider w-full sm:w-3/5 lg:w-2/5">
  </main>
</body>

</html>